<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}MyMovies{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
    {% block extra_styles %}{% endblock %}
</head>
<body>
<header class="site-header">
    <div class="header-top">
        <div class="logo">
            <a href="/">üé¨ MyMovies</a>
        </div>
        {% if session.get('user_id') %}
            <div class="auth-buttons">
                <a href="/users/{{ session.user_id }}" class="user-btn">üë§ –ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å</a>
                <a href="/films/new" methods = "GET" class="user-btn">‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ñ—ñ–ª—å–º</a>
                <a href="/logout" class="user-btn" style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white;">–í–∏–π—Ç–∏</a>
            </div>
        {% else %}
            <div class="auth-buttons">
                <!-- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–æ–≤—ñ –∫–ª–∞—Å–∏ –∫–Ω–æ–ø–æ–∫ -->
                <a href="/login" class="btn btn-primary">–í—Ö—ñ–¥</a>
                <a href="/register" class="btn btn-success">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
            </div>
        {% endif %}
    </div>

    {% block search_form %}
    <form action="/films" method="get" class="search-form">
        <div class="search-main-row">
            <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞ —Ñ—ñ–ª—å–º—É..." class="main-input">
            <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ—à—É–∫—É -->
            <button type="submit" name="search" class="btn btn-danger">üîç –ü–æ—à—É–∫</button>
        </div>

        <details class="filters-dropdown">
            <summary>–î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏</summary>

            <div class="filter-group">
                <div class="metadata-column">
                    <input type="number" name="year" placeholder="–†—ñ–∫" min="1900" max="2099">

                    <select name="country">
                        <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –∫—Ä–∞—ó–Ω—É</option>
                        {% if countries %}
                            {% for one_country in countries %}
                                <option value="{{ one_country['country_name'] }}">{{ one_country.country_name }}</option>
                            {% endfor %}
                        {% endif %}
                    </select>

                    <select name="genre">
                        <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –ñ–∞–Ω—Ä</option>
                        {% if genres %}
                            {% for genre in genres %}
                                <option value="{{ genre['genre'] }}">{{ genre.genre }}</option>
                            {% endfor %}
                        {% endif %}
                    </select>
                </div>

                <div class="actor-column">
                    <label>–ê–∫—Ç–æ—Ä–∏:</label>
                    <input type="text" name="first_name" placeholder="–Ü–º'—è">
                    <input type="text" name="last_name" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ">
                </div>
            </div>
        </details>
    </form>
    {% endblock %}
</header>

   {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
            {% for category, message in messages %}
                <div class="flash-message flash-{{ category }}">
                    <span class="flash-icon">
                        {% if category == 'success' %}‚úÖ{% elif category == 'error' %}‚ùå{% else %}‚ÑπÔ∏è{% endif %}
                    </span>
                    <span class="flash-text">{{ message }}</span>
                    <button class="flash-close" onclick="this.parentElement.style.display='none';">&times;</button>
                </div>
            {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <main>
        {% block content %}
        {% endblock %}
    </main>
</body>
</html>